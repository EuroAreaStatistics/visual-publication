!function(){"use strict";function t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function u(i){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?t(Object(o),!0).forEach(function(e){var t,n,r;t=i,r=o[n=e],n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(o,e))})}return i}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(u){var t=u.dataSets[0].series,e=u.structure.attributes.observation,c=u.structure.dimensions.observation[0],l=e.map(function(e,t){return[t,e]}).filter(function(e){return"OBS_STATUS"===s(e,2)[1].id})[0],f=u.structure.dimensions.series,d={};Object.keys(t).forEach(function(a){var s=t[a];Object.keys(s.observations).forEach(function(e){var t,n,r=s.observations[e],i=null===r[0],o=(t=r,l?l[1].values[t[l[0]+1]]:{A:"Normal value"});i||-1===p.indexOf(o.id)?(!i&&v&&console.log(u.structure.links[0].href.split("/").slice(-2,-1).concat((n=a.split(":"),f.map(function(e,t){return e.values[n[t]]}).map(function(e){return e.id}))).join("."),"removed ".concat(o.id," (").concat(o.name,")"),c.values[e].name),delete s.observations[e]):d[e]=!0}),0===Object.keys(s.observations).length&&delete t[a]});for(var n=c.values,r=[],i=!1,o=0,a=0;o<n.length;o++)d[o]&&(r.push([o,a]),o!==a&&(i=!0),a++);return c.values=n.filter(function(e,t){return d[t]}),i&&Object.keys(t).forEach(function(e){var i=t[e],o={};r.forEach(function(e){var t=s(e,2),n=t[0],r=t[1];n in i.observations&&(o[r]=i.observations[n])}),i.observations=o}),u}function b(t,e){var n=["lastNObservations","startPeriod"].filter(function(e){return e in t});return e?e+"/"+t.code.replace(".","/")+encodeURIComponent((n.length?"?":"")+n.map(function(e){return"".concat(e,"=").concat(t[e])}).join("&")):"https://sdw-wsrest.ecb.europa.eu/service/data/"+t.code.replace(".","/")+(n.length?"?":"")+n.map(function(e){return"".concat(e,"=").concat(encodeURIComponent(t[e]))}).join("&")}function i(m){return function(t){function u(e){return!m.singleTimePeriod||e.name===i}var e=b(m),n=m.description,c=t.structure.links[0].href.split("/")[6],l=t.structure.dimensions.observation[0].values,f=t.structure.dimensions.series,r=t.structure.attributes.series,i=l.map(function(e){return e.name}).sort().reverse()[0],o="";r.forEach(function(e){!e.values.length||"TITLE_COMPL"!==e.id&&"COMMENT_TS"!==e.id||(o=e.values[0].name)}),o&&(f.forEach(function(e){1<e.values.length&&(o=o.replace(e.values[0].name,""))}),o=(o=(o=o.replace(/- *[,-]/g,"-")).replace(/, *,/g,",")).replace(/^ *, */g,"")),m.methodology&&(o=m.methodology);function a(e){var i=t.dataSets[0].series[e],r=e.split(":"),o=[],a=[c];f.forEach(function(e,t){var n=e.values[r[t]];a.push(n.id),1<e.values.length&&o.push(n.name)}),o.unshift(a.join("."));var s=!1;l.forEach(function(e,t){if(u(e)){var n=i.observations[t],r=void 0!==n?n[0]:null;null!==r&&(s=!0),o.push(r)}}),s&&d.push(o)}var s=["Statistical Data Warehouse code"].concat(f.filter(function(e){return 1<e.values.length}).map(function(e){return e.name})).concat(l.filter(u).map(function(e){return e.name})),d=[s];for(var v in t.dataSets[0].series)a(v);var p=[[n],[o],["URL: ".concat(e)],[]],h=XLSX.utils.aoa_to_sheet(p.concat(d));return h["!merges"]=[{s:{r:0,c:0},e:{r:0,c:10}},{s:{r:1,c:0},e:{r:1,c:10}},{s:{r:2,c:0},e:{r:2,c:10}}],h["!cols"]=s.map(function(e,t){var n=e.length;return d.forEach(function(e){e[t]&&e[t].length>n&&(n=e[t].length)}),{width:n+1}}),h}}var o,v="undefined"!=typeof window&&/debug/.test(window.location.hash),p=["A","P","U"],a={},c=[{code:"SUR.Q.I8.N.ECFIN.CNS051_25+CNS051_50+CNS051_75.TT",startPeriod:"2004-01",description:"Business and consumer surveys - qualitative and quantitative inflation perceptions",methodology:"Quantitative inflation perceptions of households, median, 25% and 75% percentiles, annual percentage changes"}],l=(o="../../data",function(e){var r=b(e,o);return r in a||(a[r]=new Promise(function(e,t){var n=new XMLHttpRequest;n.addEventListener("load",function(){200<=this.status&&this.status<400?e(JSON.parse(this.responseText)):t(this.status+" "+this.statusText)}),n.open("GET",r),n.setRequestHeader("Accept","application/json"),n.send()}).then(function(e){return n(e)})),a[r]});c.map(function(e){return b(e)});window.fetchDataSet=function(e){return l(c[e]).then(function(t){var r={REF_AREA:"geo",TIME_PERIOD:"time"},i={I8:"EA",GB:"UK",GR:"EL"},e=t.structure.dimensions.series.concat(t.structure.dimensions.observation),o=e.map(function(e){return e.values.length});o.shift();var n=e.filter(function(e){return 1!=e.values.length}).map(function(e){var t=e.id in r?r[e.id]:e.id,n="geo"===t?e.values.map(function(e){var t=e.id in i?i[e.id]:e.id;return u(u({},e),{},{id:t})}):e.values;return u(u({},e),{},{id:t,values:n})}),a={};Object.keys(t.dataSets[0].series).forEach(function(e){var n=t.dataSets[0].series[e],r=0;e.split(":").forEach(function(e,t){r+=parseInt(e),r*=o[t]}),Object.keys(n.observations).forEach(function(e){var t=n.observations[e][0];a[r+parseInt(e)]=t})});var s={};return n.forEach(function(i){s[i.id]={category:{index:{}}},i.values.forEach(function(e,t){var n=e.id;if("time"===i.id){var r=n.split("-Q");n=r[0]+"-"+("0"+(3*r[1]-2)).slice(-2)}s[i.id].category.index[n]=t})}),{class:"dataset",value:a,dimension:s,id:n.map(function(e){return e.id}),size:n.map(function(e){return e.values.length}),extension:{datasetId:"nama_10_gdp"}}})},window.downloadDataSet=function(e){return l(c[e]).then((r=c[e],function(e){var t=i(r)(e),n=XLSX.utils.book_new();XLSX.utils.book_append_sheet(n,t),XLSX.writeFile(n,"exportedData.xlsx")}));var r},window.getValue=function(o,a){var e=o.id.reduce(function(e,t,n){if(null!=e){e*=o.size[n];var r=a[t];null==r&&(console.log("dim missing: "+t),r=0);var i=o.dimension[t].category.index[r];if(null!==i)return e+=i}},0);return e in o.value?o.value[e]:null},/[?&]simple=simple/.test(window.location.search)&&document.querySelector("html").classList.add("simple")}();
